---
export { getLocalePaths as getStaticPaths } from "lightnet/i18n"

import { AstroError } from "astro/errors"
import { getEntry } from "astro:content"
import {
  CategoriesSection,
  HeroSection,
  HighlightSection,
  MediaGallerySection,
  Page,
} from "lightnet/components"
import { getMediaItems } from "lightnet/content"

import eventImage from "../../assets/event.webp"
import heroImage from "../../assets/hero.webp"

const latestBooks = await getMediaItems({
  where: { type: "book" },
  orderBy: "dateCreated",
})

const learnSkateboarding = await getEntry(
  "media-collections",
  "learn-skateboarding",
)
if (!learnSkateboarding) {
  throw new AstroError("Media Collection 'learn-skateboarding' not found")
}

const learnSkateboardingItems = await getMediaItems({
  where: { collection: "learn-skateboarding" },
})

const { t } = Astro.locals.i18n
---

<Page>
  <HeroSection
    image={heroImage}
    title={t("x.site.title")}
    subtitle={t("x.ministry.slogan")}
    titleSize="lg"
    subtitleSize="lg"
    showSearch={true}
  />

  <MediaGallerySection
    title={t("x.home.our-latest-books")}
    items={latestBooks}
    layout="book"
  />

  <HighlightSection
    image={eventImage}
    title={t("x.home.bbq.title")}
    text={t("x.home.bbq.text")}
    link={{
      href: "mailto:some-email-address-from-the-ministry",
      text: t("x.home.bbq.sign-up-now"),
    }}
  />

  <CategoriesSection titleHref={`/${Astro.currentLocale}/categories`} />

  <MediaGallerySection
    title={learnSkateboarding.data.label}
    items={learnSkateboardingItems}
    layout="video"
  />
</Page>
