---
export { getLocalePaths as getStaticPaths } from "lightnet/i18n"

import { AstroError } from "astro/errors"
import { getEntry } from "astro:content"
import {
  CategoriesSection,
  HeroSection,
  HighlightSection,
  MediaGallerySection,
  Page,
} from "lightnet/components"
import { getMediaItems } from "lightnet/content"
import { searchPagePath } from "lightnet/utils"

import eventImage from "../../assets/event.webp"
import heroImage from "../../assets/hero.webp"

const latestBooks = await getMediaItems({
  where: { type: "book" },
})

const learnSkateboarding = await getEntry(
  "media-collections",
  "learn-skateboarding",
)
if (!learnSkateboarding) {
  throw new AstroError("Media Collection 'learn-skateboarding' not found")
}

const learnSkateboardingItems = await getMediaItems({
  where: { collection: "learn-skateboarding" },
})

const { t, currentLocale } = Astro.locals.i18n
---

<Page>
  <HeroSection
    image={heroImage}
    title={t("siteTitle")}
    subtitle={t("ministrySlogan")}
    titleSize="lg"
    subtitleSize="lg"
    showSearch={true}
  />

  <CategoriesSection titleHref={`/${Astro.currentLocale}/categories`} />

  <MediaGallerySection
    title={t("homeOurLatestBooks")}
    titleHref={searchPagePath(currentLocale, { type: "book" })}
    items={latestBooks}
    layout="book"
    viewLayout="carousel"
  />

  <HighlightSection
    image={eventImage}
    title={t("homeBbqTitle")}
    text={t("homeBbqText")}
    link={{
      href: "mailto:some-email-address-from-the-ministry",
      text: t("homeBbqSignUpNow"),
    }}
  />

  <MediaGallerySection
    title={t(learnSkateboarding.data.label)}
    items={learnSkateboardingItems}
    layout="video"
  />
</Page>
