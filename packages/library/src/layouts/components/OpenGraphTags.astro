---
import { getImage } from "astro:assets"
import projectContext from "virtual:lightnet/project-context"

import type { OpenGraphProps } from "./open-graph-props"

type Props = OpenGraphProps & {
  siteName: string
}

const { site } = projectContext
if (!site) {
  return
}

const image = await getImage({
  src: Astro.props.image,
  format: "jpg",
})
---

<meta property="og:title" content={Astro.props.title} />
<meta property="og:description" content={Astro.props.description} />
<meta property="og:type" content="website" />
<meta property="og:site_name" content={Astro.props.siteName} />
<meta
  property="og:url"
  content={`${site.replace(/\/$/g, "")}/${Astro.props.id.replace(/^\//g, "")}`}
/>
<meta property="og:image" content={image.src} />
<meta property="og:image:type" content="image/jpeg" />
<meta property="og:image:width" content={image.attributes["width"]} />
<meta property="og:image:height" content={image.attributes["height"]} />
