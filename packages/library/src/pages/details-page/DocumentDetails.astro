---
import { Image } from "astro:assets"

import Section from "../../components/Section.astro"
import CommonMetaData from "./components/CommonMetaData.astro"
import Description from "./components/Description.astro"
import DocumentActions from "./components/DocumentActions.astro"
import type { Props as DetailsProps } from "./details-props"

export type Props = DetailsProps & {
  showBookFold: boolean
}

const { mediaItem, showBookFold } = Astro.props
const { description, language, image, title } = mediaItem
---

<Section
  withoutDefaultTopMargin
  class="pt-4 sm:pt-8 lg:pt-12"
  lang={mediaItem.language}
>
  <div
    class="flex flex-col justify-center gap-8 sm:flex-row-reverse md:gap-12"
    lang={mediaItem.language}
  >
    <div class="grow">
      <CommonMetaData {...Astro.props} />
      <DocumentActions class="my-8 sm:hidden" mediaItem={mediaItem} />
      <Description description={description} />
    </div>
    <div
      class="flex h-full min-w-64 shrink flex-col items-stretch gap-8 md:min-w-72"
    >
      <a
        class="relative overflow-hidden rounded-sm shadow-md"
        href={mediaItem.contentUrls[0]}
        hreflang={language}
      >
        <Image
          src={image}
          alt={title}
          class="w-full"
          widths={[150, 256, 512, 768]}
          sizes="(max-width: 640px) calc(100vw - 2rem), (max-width: 768px) 16rem, 18rem"
        />
        {
          showBookFold && (
            <span class="absolute left-[3px] top-0 h-full w-[4px] bg-gradient-to-r from-gray-500/20 to-transparent" />
          )
        }
      </a>
      <DocumentActions class="hidden sm:flex" mediaItem={mediaItem} />
    </div>
  </div>
</Section>
